\documentclass{like}

%\selectlanguage{english}
%\selectlanguage{german}


\begin{document}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Ab hier beginnt der Text
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  

%\normalsize
\include{Inhalt/Titelseite2}
\include{Inhalt/Bestaetigung}
\include{Inhalt/Acknowledgement} %Optional
\include{Inhalt/Thema_Aufgabenstellung}
\include{Inhalt/Kurzzusammenfassung}
\include{Inhalt/Abstract}
%\include{Inhalt/Abkuerzungsverzeichnis} (nach hinten verschoben)
\include{Inhalt/Content} %Bitte 2x kompilieren - sonst erscheint es nicht


\pagenumbering{arabic} %Seitennummerierung arabisch
\setcounter{page}{1}   %1. Kapitel soll mit Seitenzahl 1 beginnen
%------------------------------------------------------------------

\chapter{Autonomes Fahren}

\section{Stand der Technik}
Gegen Ende des Jahres 2018, also nur wenigen Monaten nachdem diese Zeilen verfasst werden, wird Alphabets Tochterunternehmen Waymo die ersten voll autonomen (Level 5) Fahrzeuge als Taxis in Phoenix in Betrieb nehmen \cite{Waymo}. Dieser historische Moment wird eine Flut an neuen Assistenzsystem nach sich ziehen die in wenigen Jahren das Straßenbild verändern werden. \\
Während sich die traditionellen Automobilhersteller aktuell auf Assistenzsysteme im Bereich von Level zwei und drei konzentrieren, wollen Unternehmen wie Google, GM und Uber alle Zwischenschritte überspringen und direkt voll autonom fahren um fahrerlose Taxiflotten aufzubauen. Dies ist nach aktuellem Stand der Technik jedoch nur kostengünstig und mit Rechnerplattformen welche in bestehende Fahrzeugkonzepte integrierbar sind realisierbar wenn die Fahrzeuge auf eine genaue Umgebungskarte zurückgreifen können. Erst mit Echtzeitupdates und bei einer Genauigkeit von +-10 cm des Kartenmaterials können Fahrzeug auch im innerstädtischen Verkehr autonom fahren \cite{SEIF2016159}. 
Nicht nur im normalen Straßenverkehr ist ein möglichst genaues Wissen der Umgebung von Vorteil, auch bei autonomen Rennserien spielt die Kenntnis über den Rennkurs eine große Rolle. Kann das Fahrzeug nur auf Sicht fahren muss die Geschwindigkeit so gewählt werden, dass innerhalb der Sichtweite angehalten werden kann. Außerdem ist das berechnen einer idealen Trajektorie nur möglich wenn die gesamte Strecke bekannt ist.


\section{Formula Student Driverless}

Die Formula Student ist ein Ingenieurswettbewerb für Studenten. Er hat seine Wurzeln in den USA im Jahre 1981 und wurde ab 1998 auch in Europa ausgetragen.
Dass der Wettbewerb sehr Erfolgreich ist, machen nicht nur die inzwischen fast 700 Teams Weltweit \cite{FsWorldRank:1} deutlich, sondern auch die Anzahl der verschiedenen Events die überall auf der Welt im Sommer stattfinden. Seit dem Jahr 2017 gibt es neben der ursprünglichen Combustion-Klasse und der vor 10 Jahren eingeführten Electric-Klasse auch noch die Driverless-Klasse.
In dieser wird von den Teams ein Altfahrzeug um ein Sensorsystem sowie Aktoren so erweitert, dass das Rennauto die Kurse autonom bestreiten kann.
Der Wettbewerb ist unterteilt in Dynamische und Statische Events. In letzteren werden verschiedene Präsentationen von den Teams verlangt. Diese beziehen sich auf die technische Realisierung, Softwaredesign, Kostenaufstellung und ein Businessplan in dem die Teams ein Konzept erstellen müssen wie man das gebaute Fahrzeug über eine kleine Massenfertigung gewinnbringend verkaufen kann.

Die dynamischen Disziplinen, in denen das Fahrzeug selbstständig fährt, sind hierbei:
\begin{itemize}
	\item Acceleration \\ 75 Meter Beschleunigungsstreifen. Punkte werden nach der Zeit nicht nach der Endgeschwindigkeit vergeben.
	\item Skidpad \\ eine liegende 8 bei an der Engstelle eingefahren wird und jeweils 2 rechte und 2 linke Runden gefahren werden. Jeweils die zweite Runde wird gezählt. Die Abmaße sind exakt vorgegeben.
	\item Trackdrive \\ ein bis zu 800 Meter langer Kurs mit maximal 80 Meter langen geraden und Kurven mit minimalem Innenradius von 9 Metern. Es werden 11 runden gefahren und die Teams erhalten im Vornherein keine Möglichkeit Messungen am Kurs vorzunehmen.
\end{itemize}

Für diese Arbeit ist vorallem der Trackdrive von Interesse. Es wird davon ausgegangen dass das Fahrzeug bereits die erste Runde absolviert, und sich damit eine genaue Karte des Rennkurses erstellt hat. Die Messungen und Vergleiche beziehen sich damit auch immer auf einen Kurs der so (wenn auch nicht so kurz) in einem FS-Event für die Driverless Fahrzeuge vorkommen könnte.
 
\begin{figure}[hb!]
	\caption{Zürichs FS-Driverless Fahrzeug im Jahr 2017 während des Trackdrive}
	\includegraphics[width=200pt]{Abbildungen/amz-driverless-long.jpg}
\end{figure}


\chapter{Grundlagen}

\section{Fahrzeugmodelle}
Wie der Name Model Predictive Control schon verdeutlicht benötigt man eine Systembeschreibung des zu Regelnden Modells. Diese wird genutzt um zukünftige Zustände zu Berechnen und bildet damit einen wichtigen Bestandteil. Desto genauer die Beschreibung das realen System approximiert, desto besser ist die Vorhersage und damit auch die Regelung des Fahrzeugs.
Im folgenden wird zuerst ein kinematisches Fahrzeugmodell eingeführt und dann zu einem dynamischen Modell erweitert.   

\subsection{Kinematisches Modell}
Unter gewissen Einschränkungen welche weiter unten beschrieben werden kann ein kinematisches Modell die Laterale und Longitudinale Bewegung eines Fahrzeuges mathematisch Beschreiben. In diesem sehr stark vereinfachten Modell werden keine wirkenden Kräfte berücksichtigt, sondern nur die geometrischen Beziehungen des Fahrzeuges genutzt um die Bewegung zu berechnen. \\
Im ersten Schritt werden die jeweils an einer Achse verbundenen Räder zu einem einzigen Zusammengefasst \cite{BicycleModel}. Dies wird als Bicycle Modell bezeichnet und vereinfacht die Berechnungen erheblich. Obwohl auch für Hinterradlenkung möglich, wird im folgenden nur die Vorderradlenkung betrachtet da das Driverless Fahrzeug der Uni Erlangen nur über eine solche verfügt. Die Lenkwinkel welche durch das Bicycle Modell berechnet werden entsprechen nicht den Lenkwinkel am echten Fahrzeug. Die kurveninneren und kurvenäußeren Räder bewegen sich auf zwei Kreisen mit unterschiedlichen Radien, und damit auch verschiedenen Lenkwinkeln. Dies wird in Fahrzeugen durch die Ackermann Lenkung mechanisch abgebildet \cite{rajamani2011vehicle}.


Die nichtlinearen zeitkontinuierlichen Gleichungen basieren auf \cite{rajamani2011vehicle, 7225830} und beschreiben das kinematische Modell bezüglich eines Inertialsystems (siehe Abbildung \ref{fig:kinmodel}),

\begin{figure}[ht!]
	\caption{Kinematisches Modell}
	\includegraphics[width=400pt]{Abbildungen/kin_bicycle.png}
	\label{fig:kinmodel}
\end{figure}

\begin{eqnarray}
\ddot{x}   &= &v  \cos(\psi + \beta)\\
\ddot{y}   &= &v  \sin(\psi + \beta)\\
\dot{\psi} &= &\frac{v}{l_r} \sin(\beta) \\
\dot{v}    &= &a \\
\beta      &= &\arctan(\frac{l_r}{l_f + l_r} \tan(\varphi_f))
\end{eqnarray}

in dem \(x\) und \(y\) die Koordinaten des Schwerpunktes im Inertialsystem darstellen. 
\(\varphi\) ist die Orientierung und \(v\) die Geschwindigkeit des Fahrzeugs. \(l_f\) und \(l_r\) sind die Abstände der vorderen (\(l_f)\) und hinteren (\(l_r)\) Achsen zum Schwerpunkt.
Der Schwimmwinkel (\(\beta\)) ist der Winkel  zwischen der Bewegungsrichtung des Fahrzeugs im Schwerpunkt und der Fahrzeuglängsachse bei der Kurvenfahrt. Die Beschleunigung \(a\) bezieht sich ebenfalls auf den Schwerpunkt und zeigt immer in die gleiche Richtung wie die Geschwindigkeit. \\
Die Parameter lassen sich in zwei Bereiche unterteilen:

\begin{itemize}
	\item Steuerparameter  \\
			\(a\), \(\varphi\)
	\item Zustandsgrößen \\
			\(x\), \(y\), \(v\), \(\varphi\)
	
\end{itemize}


Die Annahme eines kräftefreien Modells, bei dem das Vorderrad genau in die Richtung rollt in die es zeigt, ist nur bis etwa 5 m/s anwendbar \cite{rajamani2011vehicle}. Danach müssen die Kräfte welche die Reifen auf die Straße übertragen können mit betrachtet werden. Diese Kräfte werden dann im dynamischen Modell genutzt um eine genauere Vorhersage berechnen zu können.



\subsection{Reifenmodell}
Da die Reifen der einzige Kontaktpunkt zwischen Straße und Fahrzeug sind, beeinflussen sie ganz erheblich das Verhalten des Rennautos.
Aus diesem Grund werden zuerst die Grundlagen des Reifenmodells vermittelt bevor das dynamische Fahrzeugmodell eingeführt wird.

Luft gefüllte Reifen haben nicht nur einen Kontaktpunkt mit der Straße sondern aufgrund von elastischer Verformung, hervorgerufen durch vertikale Belastung, einen Kontaktbereich. Alle Kräfte die auf den Reifen wirken gehen vom Mittelpunkt dieses Bereichs aus und lassen sich in drei Achsen aufteilen. Von Interesse für diese Arbeit ist die X-Achse welche in Laufrichtung, und die Y-Achse welche in Richtung der Rotationsachse zeigt. Die jeweiligen Kräfte dazu werden als \(F_x\) und \(F_y\) bezeichnet. Die Normalkraft die den Reifen auf die Straße presst \(F_z\) wird als konstant angesehen und berechnet sich aus dem Gewicht und der Radlastverteilung.

Die lateralen Kräfte welche zwischen Straße und Reifen entstehen hängen vom Schräglaufwinkel (slip angle) ab. Er ist definiert als der Winkel zwischen der Orientierung des Reifen und der Orientierung des Geschwindigkeitsvektors des Reifen (siehe \ref{fig:linLat})

\begin{figure}[ht!]
	\caption{Kinematisches Modell}
	\includegraphics[width=400pt]{Abbildungen/linLat.png}
	\label{fig:linLat}
\end{figure}

\begin{equation}
\alpha_f = \delta - \theta_{vf}
\end{equation}
Der gleiche Zusammenhang gilt auch für das hintere Rad welches jedoch in unserem Fall nicht gelenkt wird.
\begin{equation}
\alpha_r = \theta_{vr}
\end{equation}

Für kleine Schräglaufwinkel besteht ein linearer Zusammenhang aus lateraler Kraft und Winkel. 
\begin{eqnarray}
F_{yf} = C_\alpha \alpha_f \\
F_{yr} = C_\alpha \alpha_r
\end{eqnarray}

Am Schaubild \ref{fig:pacejka} lässt sich dieser Bereich sehr gut erkennen.
Auch dass für größere Schräglaufwinkel die Kräfte anders berechnet werden müssen ist ersichtlich. Hierfür wird die so genannte \textit{Magic Formula} verwendet. Dabei handelt es sich um eine mathematische Gleichung die sehr gut Messkurven approximiert welche auf Testständen gemessen werden.
Es wurde 1993 von Pacejka und Bakker entwickelt, und eignet sich sowohl für die Berechnung der longitudinalen wie auch der lateralen Kräfte . Bei Eingabe des Schräglaufwinkels in \(x\) erhält man die lateral auf die Straße wirkende Kraft \(F_y\). 
 \begin{equation}
 F_y = D\sin[C\arctan{Bx - E(Bx - \arctan(Bx))}]
 \label{eq:magicF}
 \end{equation}
 
 \begin{figure}[ht!]
 	\caption{Tire Model}
 	\includegraphics[width=350pt]{Abbildungen/pacejka.png}
 	\label{fig:pacejka}
 \end{figure}
 
 
Da in der später genutzten Simulation kein Motor simuliert wird, kann der Schlupf und damit die exakte longitudinale Kraft die der Reifen wirkt nicht berechnet werden. Stattdessen wird die Kraft über die Leistung, Reibung und Luftwiederstand berechnet (siehe Section \ref{dynModel}) und durch \(F_{max}\) begrenzt. \\
Der Zusammenhang zwischen lateraler und longitudinaler Kraft wird über den \textit{Kammschen Kreis} Modelliert (siehe Schaubild \ref{fig:kamKreis}). Dieser schränkt die wirkenden Kräfte so ein, dass die Kathete aus \(F_x\) und \(F_y\) sich maximal auf einem Einheitskreis bewegen kann. Dieser hat den Radius der maximalen Kraft die der Reifen übertragen kann (\(F_{max}\)).

\begin{eqnarray}
	F <= F_{max} \\
	F = \sqrt{F_x^2 + F_y^2}  \\
	|F_y| <= F_{max}^2 - F_x^2
\end{eqnarray}
In Kombination mit \ref{eq:magicF} erhält man
 \begin{equation}
	|D\sin[C\arctan{Bx - E(Bx - \arctan(Bx))}]| <= F_{max}^2 - F_x^2
 \end{equation}

\begin{figure}[ht!]
	\caption{Kammscher Kreis}
	\includegraphics[width=400pt]{Abbildungen/kamKreis.jpg}
	\label{fig:kamKreis}
\end{figure}
	
	

Die Parameter, welche für die \textit{Magic Formula} benötigt werden, wurden vom High Octane Motorsports e.V. zur Verfügung gestellt und beziehen sich auf das Fahrzeug des Jahres 2017.

\begin{tabular}[t]{lr}
	B	&	0.71 \\
	C	&	1.40 \\
	D	&	1.00 \\
	E	&  -0.20 \\
\end{tabular}

Mit dem Wissen wie die lateralen Kräfte berechnet werden, kann nun ein genaueres Systemmodell genutzt werden.

\subsection{Dynamisches Fahrzeugmodell}
\label{dynModel}

Die Basis ist wie auch schon beim kinematischen Modell das \textit{bicycle model}. Es wird nun um die durch das zweite newtonsche Gesetz entstehenden Kräfte entlang der \(y\)-Achse erweitert.

\begin{equation}
ma_y = F_{yf} + F_{yr}
\end{equation}   



Die Kräfte \(F_{yf}\) und \(F_{yr}\) greifen jeweils am vorderen \((.)_f\) und hinteren \((.)_r\) Rad an und verlaufen senkrecht zur Radlaufrichtung (siehe Schaubild \ref{fig:dynModel}).

\begin{figure}[hb!]
	\caption{Dynamic Vehicle Model}
	\includegraphics[width=350pt]{Abbildungen/dynModel.png}
	\label{fig:dynModel}
\end{figure}

Wobei\(a_y\) aus zwei Anteilen besteht, der Querbeschleunigung und der Zentripetalkraft.



Zusätzlich muss das Drehmoment um die \(z\)-Achse betrachtet werden.
\begin{equation}
I_z \ddot{\psi} = l_f F_{yf} - l_r F_{yr}
\end{equation}
Daraus lassen sich die Gleichungen für Longitudinal-, Lateral- und Drehbewegung aufstellen.

\begin{eqnarray}
	m \ddot{x} = m \dot{y} \dot{\psi} + 2 F_{xf} + 2 F_{xr} \\
	m \ddot{y} = - m \dot{x} \dot{\psi} + 2 F_{yf} + 2 F_{yf} \\
	I \ddot{(\psi)} = 2 l_f F_{yf} - 2 l_r F_{yr}
\end{eqnarray}

Die finale Bewegungsgleichung lautet
\begin{eqnarray}
\dot{X} =& \dot{x} \cos(\psi) - \dot{y} \sin(\psi) \\
\dot{Y} =& \dot{x} \sin(\psi) - \dot{y} \cos(\psi) \\
m \ddot{x} =& m \dot{y} \dot{\psi} + 2F_{xf} + 2 F_{xr} - F_a \\
m \ddot{y} =& - m \dot{x} \dot{\psi} + 2 F_{yf} + 2 F_{yr} \\
I \ddot{\psi} =& 2 l_f F_{yf} - 2 l_r F_{yr} \\
\end{eqnarray}

und in diskreter Form

\begin{eqnarray}
X_{k+1} =& X_k + \Delta t(\dot{x}_k \cos(\Psi_k) - \dot{y}_k \sin(\Psi_k) \\
Y_{k+1} =& Y_{k} + \Delta t(\dot{x}_k \sin(\Psi_k) - \dot{y}_k \cos(\Psi_k) \\
\dot{\Psi}_{k+1} =& \Psi_k + \Delta t \dot{\psi}_k \\
\dot{x}_{k+1} =&  \dot{x}_k + \Delta t (\frac{2F_{xf_k} + 2 F_{xr_k}- F_a}{m} + \dot{y}_k \dot{\psi}_k) \\
\dot{y}_{k+1} =&  \dot{y}_k + \Delta t (\frac{2 F_{yf_k} + 2 F_{yr_k}}{m} - \dot{x}_k \dot{\psi}_k)  \\
\ddot{\psi}_{k+1} =& \dot{\psi}_k + \Delta t \frac{2 l_f F_{yf} - 2 l_r F_{yr}}{I} \\
\end{eqnarray}

Im dynamische Fahrzeugmodell ändert sich damit auch der Zustandsvektor: \\
\(X\), \(Y\), \(x_d\), \(y_d\), \(\psi\), \(\dot{\psi}\) \\
Der Steuervektor ist gleich geblieben.

Die zur Berechnung verwendeten Fahrzeugparameter

\begin{tabular}[t]{lrr}
	Formelzeichen & Wert & Einheit\\
	\(l_f\)	&	1.09 & m\\
	\(l_r\)	&	0.9 & m\\
	\(l_b\)	&	1.99 & m \\
	\(r\)	&	0.2 & m \\
	\(m\)	&  	163 & kg\\
	\(I\)	&  	1000 & kgm\textsuperscript{2}\\
	\(A_f\)	&  	1.5 & m\textsuperscript{2}\\
	\(P_{engine}\) &  40,5 & kW\\
	\(C_d\)	&  	1.5 & - \\
	\(\rho\)	&  	1.225 & kg / m\textsuperscript{3}\\
	\(F_max\)	&  	3 & kN \\

\end{tabular}








\section{Nichtlineare Programmierung}

\section{Model Predictive Control}
\section{Simulation}





\chapter{Konzept}



\chapter{Ergebnisse}




\chapter{Diskussion}

\chapter[Zusammenfassung]{Zusammenfassung und Ausblick}


\appendix

\include{Inhalt/Anhang}

\include{Inhalt/Abkuerzungsverzeichnis}

%\bibliographystyle{IEEEtran}
\bibliographystyle{alpha}
\bibliography{Inhalt/literatur}

% Bitte noch Index anhängen (kommt unter Linux zu Fehlermeldungen)
%\input{Inhalt/index}

%bitte Lebenslauf anhängen !!!
% kommt unter Linux zu Fehlermeldungen
\input{Inhalt/cvalt}



\end{document}



 
